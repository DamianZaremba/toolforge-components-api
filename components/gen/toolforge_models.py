# generated by datamodel-codegen:
#   filename:  https://api-docs.toolforge.org/openapi.json
#   timestamp: 2025-10-08T11:27:47+00:00

from __future__ import annotations

from enum import Enum
from typing import Annotated, Dict, List, Literal, Optional, Union
from uuid import UUID

from pydantic import AnyUrl, AwareDatetime, BaseModel, Field, RootModel


class BuildsBuildLog(BaseModel):
    line: Optional[str] = None


class BuildsBuildParameters(BaseModel):
    envvars: Annotated[
        Optional[Dict[str, str]],
        Field(description="Environment variables and values to be set at build time"),
    ] = None
    image_name: Annotated[
        Optional[str], Field(description="The name of the image to be built")
    ] = None
    ref: Annotated[
        Optional[str],
        Field(description="Source code reference to build (ex. a git branch name)"),
    ] = None
    source_url: Annotated[
        str,
        Field(
            description="URL to the public git repository that contains the source code\nto build\n"
        ),
    ]
    use_latest_versions: Annotated[
        Optional[bool],
        Field(
            description="<- If set, it will use the latest available versions of the builder+runner images, recommended if you want to be able to have some buffer before the old versions are removed"
        ),
    ] = False


class BuildsBuildStatus(Enum):
    BUILD_PENDING = "BUILD_PENDING"
    BUILD_RUNNING = "BUILD_RUNNING"
    BUILD_SUCCESS = "BUILD_SUCCESS"
    BUILD_FAILURE = "BUILD_FAILURE"
    BUILD_CANCELLED = "BUILD_CANCELLED"
    BUILD_TIMEOUT = "BUILD_TIMEOUT"
    BUILD_UNKNOWN = "BUILD_UNKNOWN"


class Status(Enum):
    OK = "OK"
    ERROR = "ERROR"


class BuildsNewBuild(BaseModel):
    name: Optional[str] = None
    parameters: Optional[BuildsBuildParameters] = None
    resolved_ref: Optional[str] = None


class BuildsQuotaCategoryItem(BaseModel):
    available: Optional[str] = None
    capacity: Optional[str] = None
    limit: Optional[str] = None
    name: Optional[str] = None
    used: Optional[str] = None


class BuildsResponseMessages(BaseModel):
    error: Optional[List[str]] = None
    info: Optional[List[str]] = None
    warning: Optional[List[str]] = None


class BuildsStartResponse(BaseModel):
    messages: Optional[BuildsResponseMessages] = None
    new_build: Optional[BuildsNewBuild] = None


class Replicas(RootModel[int]):
    root: Annotated[
        int,
        Field(
            description="Number of replicas to be used for the job. Configurable only when continuous is true.",
            examples=[1],
            ge=1,
            title="Replicas",
        ),
    ]


class ComponentsDeployToken(BaseModel):
    token: Annotated[Optional[UUID], Field(title="Token")] = None
    creation_date: Annotated[Optional[AwareDatetime], Field(title="Creation Date")] = (
        None
    )


class BuildId(Enum):
    no_id_yet = "no-id-yet"
    no_build_needed = "no-build-needed"


class ComponentsDeploymentBuildState(Enum):
    pending = "pending"
    running = "running"
    failed = "failed"
    successful = "successful"
    unknown = "unknown"
    skipped = "skipped"
    cancelled = "cancelled"


class ComponentsDeploymentRunState(Enum):
    pending = "pending"
    failed = "failed"
    successful = "successful"
    skipped = "skipped"
    unknown = "unknown"


class ComponentsDeploymentState(Enum):
    pending = "pending"
    running = "running"
    failed = "failed"
    timed_out = "timed_out"
    successful = "successful"
    cancelling = "cancelling"
    cancelled = "cancelled"


class ComponentsEmails(Enum):
    none = "none"
    all = "all"
    onfinish = "onfinish"
    onfailure = "onfailure"


class ComponentsHealthState(BaseModel):
    status: Annotated[Status, Field(title="Status")]


class ComponentsMount(Enum):
    all = "all"
    none = "none"


class ComponentsResponseMessages(BaseModel):
    info: Annotated[Optional[List[str]], Field(title="Info")] = []
    warning: Annotated[Optional[List[str]], Field(title="Warning")] = [
        "You are using a beta feature of Toolforge."
    ]
    error: Annotated[Optional[List[str]], Field(title="Error")] = []


class Retry(RootModel[int]):
    root: Annotated[
        int,
        Field(
            description="Job retry policy. Zero means don't retry at all (the default)",
            examples=[0],
            ge=0,
            le=5,
            title="Retry",
        ),
    ]


class Timeout(RootModel[int]):
    root: Annotated[
        int,
        Field(
            description="Maximum amount of seconds the job will be allowed to run before it is failed",
            examples=[120],
            ge=0,
            title="Timeout",
        ),
    ]


class ComponentsScheduledRunInfo(BaseModel):
    command: Annotated[
        str,
        Field(
            description="Command to use to run this component, `launcher` will be prepended to it to load the environment if needed.",
            examples=["bash -c 'while date; do sleep 10; done'"],
            title="Command",
        ),
    ]
    cpu: Annotated[
        Optional[str],
        Field(description="Job CPU resource limit.", examples=["1"], title="Cpu"),
    ] = None
    emails: Annotated[
        Optional[ComponentsEmails],
        Field(description="Job emails setting.", examples=["all"]),
    ] = None
    filelog: Annotated[
        Optional[bool],
        Field(
            description="Whether this job uses filelog or not.",
            examples=[False],
            title="Filelog",
        ),
    ] = None
    filelog_stderr: Annotated[
        Optional[str],
        Field(
            description="Path to the stderr file log.",
            examples=["logs/my-job.err"],
            title="Filelog Stderr",
        ),
    ] = None
    filelog_stdout: Annotated[
        Optional[str],
        Field(
            description="Path to the stdout file log.",
            examples=["logs/my-job.out"],
            title="Filelog Stdout",
        ),
    ] = None
    memory: Annotated[
        Optional[str],
        Field(
            description="Job memory resource limit.", examples=["1G"], title="Memory"
        ),
    ] = None
    mount: Annotated[
        Optional[ComponentsMount],
        Field(
            description="NFS mount configuration for the job.", examples=["none", "all"]
        ),
    ] = None
    # manually modified to not be nullable
    retry: Annotated[
        Retry,
        Field(
            description="Job retry policy. Zero means don't retry at all (the default)",
            examples=[0],
            title="Retry",
        ),
    ] = Retry(0)
    schedule: Annotated[
        str,
        Field(
            description="If the job is a cronjob, execution schedule.",
            examples=["@hourly", "*/15 * * * *"],
            title="Schedule",
        ),
    ]
    timeout: Annotated[
        Optional[Timeout],
        Field(
            description="Maximum amount of seconds the job will be allowed to run before it is failed",
            examples=[120],
            title="Timeout",
        ),
    ] = None


class ComponentsSourceBuildInfo(BaseModel):
    repository: Annotated[
        AnyUrl,
        Field(
            description="URL of the public git repository with the code to build.",
            examples=[
                "https://gitlab.wikimedia.org/toolforge-repos/sample-complex-app-backend"
            ],
            title="Repository",
        ),
    ]
    ref: Annotated[
        str,
        Field(
            description="Git ref to build from. This can be a tag, a branch name or a commit SHA.",
            examples=["main", "v1.2.3", "35b594f5d452c288c4a15fe667a7dfb94a7e5489"],
            title="Ref",
        ),
    ]
    use_latest_versions: Annotated[
        Optional[bool],
        Field(
            description="If set, it will use the latest buildpacks and run images for this build. Helpful to always get the latest versions or test them before they become standard.",
            title="Use Latest Versions",
        ),
    ] = False


class ComponentsSourceBuildReference(BaseModel):
    reuse_from: Annotated[
        str,
        Field(
            description="Component to re-use the build from.",
            examples=["parent-component"],
            title="Reuse From",
        ),
    ]


class SourceUrl(RootModel[AnyUrl]):
    root: Annotated[
        AnyUrl,
        Field(
            description="If passed, it will ignore anything else and try to fetch the configuration from the given URL on every deploy.",
            title="Source Url",
        ),
    ]


class ComponentsValidationError(BaseModel):
    loc: Annotated[List[Union[str, int]], Field(title="Location")]
    msg: Annotated[str, Field(title="Message")]
    type: Annotated[str, Field(title="Error Type")]


class EnvvarsEnvvarName(RootModel[str]):
    root: Annotated[str, Field(pattern="^[A-Z][A-Z_0-9]{2,}[A-Z0-9]$")]


class EnvvarsEnvvarsQuota(BaseModel):
    quota: Annotated[
        Optional[int], Field(description="The quota available to the user")
    ] = None
    used: Annotated[Optional[int], Field(description="The quota used by the user")] = (
        None
    )


class EnvvarsResponseMessages(BaseModel):
    error: Optional[List[str]] = None
    info: Optional[List[str]] = None
    warning: Optional[List[str]] = None


class JobsResponseMessages(BaseModel):
    info: Optional[List[str]] = None
    warning: Optional[List[str]] = None
    error: Optional[List[str]] = None


class JobsRestartResponse(BaseModel):
    messages: Optional[JobsResponseMessages] = None


class JobsDeleteResponse(BaseModel):
    messages: Optional[JobsResponseMessages] = None


class JobsUpdateResponse(BaseModel):
    messages: Optional[JobsResponseMessages] = None


class JobsFlushResponse(BaseModel):
    messages: Optional[JobsResponseMessages] = None


class JobsHealth(BaseModel):
    status: Optional[Status] = None
    message: Optional[str] = None


class JobsImage(BaseModel):
    shortname: Optional[str] = None
    image: Optional[str] = None


class Item(BaseModel):
    name: Optional[str] = None
    limit: Optional[str] = None
    used: Optional[str] = None


class Category(BaseModel):
    name: Optional[str] = None
    items: Optional[List[Item]] = None


class JobsQuota(BaseModel):
    categories: Optional[List[Category]] = None


class JobsJobLogs(RootModel[str]):
    root: str


class JobsHealthCheckType(Enum):
    script = "script"
    http = "http"


class JobsScriptHealthCheck(BaseModel):
    type: Literal["script"]
    script: str


class JobsHttpHealthCheck(BaseModel):
    # manually modified as for some reason it generated it wrongly, with `path` instead of `http`
    type: Literal["http"]
    path: str


class JobsEmailOption(Enum):
    none = "none"
    all = "all"
    onfinish = "onfinish"
    onfailure = "onfailure"


class Mount(Enum):
    all = "all"
    none = "none"


class JobsCommonJob(BaseModel):
    name: Annotated[
        str,
        Field(
            description="Unique name that identifies the job.",
            examples=["my-job"],
            max_length=52,
            min_length=1,
            pattern="^[a-z0-9]([-a-z0-9]*[a-z0-9])?([.][a-z0-9]([-a-z0-9]*[a-z0-9])?)*$",
        ),
    ]
    imagename: Annotated[
        str,
        Field(
            description="Container image the job uses.",
            examples=["tool-my-tool/tool-my-tool:latest"],
        ),
    ]
    cmd: Annotated[
        str,
        Field(
            description="Command that this job is executing.",
            examples=["./some-command.sh --with-args"],
        ),
    ]
    # Manually modified to default to None, so we only send it when it's set
    filelog: Annotated[
        Optional[bool],
        Field(description="Whether this job uses filelog or not.", examples=[False]),
    ] = None
    filelog_stdout: Annotated[
        Optional[str],
        Field(description="Path to the stdout file log.", examples=["logs/my-job.out"]),
    ] = None
    filelog_stderr: Annotated[
        Optional[str],
        Field(description="Path to the stderr file log.", examples=["logs/my-job.err"]),
    ] = None
    emails: Optional[JobsEmailOption] = None
    retry: Annotated[
        Optional[int],
        Field(
            description="Job retry policy. Zero means don't retry at all (the default)",
            examples=[0],
            ge=0,
            le=5,
        ),
    ] = 0
    # Manually modified to default to None, so we only send it when it's set
    mount: Annotated[
        Optional[Mount],
        Field(description="NFS mount configuration for the job.", examples=["none"]),
    ] = None
    memory: Annotated[
        Optional[str], Field(description="Job memory resource limit.", examples=["1G"])
    ] = None
    cpu: Annotated[
        Optional[str], Field(description="Job CPU resource limit.", examples=["1"])
    ] = None


class JobType(Enum):
    one_off = "one-off"


class JobsNewOneOffJob(JobsCommonJob):
    # Manually modified to not be optional so it gets always sent
    job_type: JobType = JobType.one_off


class JobType1(Enum):
    scheduled = "scheduled"


class JobsNewScheduledJob(JobsCommonJob):
    # Manually modified to not be optional so it gets always sent
    job_type: JobType1 = JobType1.scheduled
    schedule: Annotated[
        str,
        Field(
            description="If the job is a cronjob, execution schedule.",
            examples=["@hourly"],
        ),
    ]
    timeout: Annotated[
        Optional[int],
        Field(
            description="Maximum amount of seconds the job will be allowed to run before it is failed",
            examples=[120],
            ge=0,
        ),
    ] = None


class JobType2(Enum):
    continuous = "continuous"


class PortProtocol(Enum):
    tcp = "tcp"
    udp = "udp"


class JobsNewContinuousJob(JobsCommonJob):
    continuous: Annotated[
        Optional[bool],
        Field(
            description="If a job should be always running.\nThis is deprecated and is only here for backward compatibility.\nUse job_type instead.\n",
            examples=[True],
        ),
    ] = None
    # Manually modified to not be optional so it gets always sent
    job_type: JobType2 = JobType2.continuous
    replicas: Annotated[
        Optional[int],
        Field(
            description="Number of replicas to be used for the job", examples=[1], ge=1
        ),
    ] = None
    port: Annotated[
        Optional[int],
        Field(
            description="Port to expose for the job", examples=[8080], ge=1, le=65535
        ),
    ] = None
    # manually modified to not be nullable
    # manually modified to use the enum as default
    port_protocol: Annotated[
        PortProtocol,
        Field(description="Protocol for the port exposed by the job", examples=["tcp"]),
    ] = PortProtocol.tcp
    health_check: Annotated[
        Optional[Union[JobsScriptHealthCheck, JobsHttpHealthCheck]],
        Field(
            description="Health check configuration for the job", discriminator="type"
        ),
    ] = None


class JobsDefinedCommonJob(JobsCommonJob):
    image: Annotated[
        Optional[str],
        Field(
            description="Container image the job uses.",
            examples=["tool-my-tool/tool-my-tool:latest"],
        ),
    ] = None
    image_state: Annotated[
        Optional[str],
        Field(
            description="Information about the image state, i.e, if it is stable, deprecated, or something else.",
            examples=["stable"],
        ),
    ] = None
    status_short: Annotated[
        Optional[str],
        Field(description="Job status, short text.", examples=["Running."]),
    ] = None
    status_long: Annotated[
        Optional[str],
        Field(
            description="Job status, extended text.",
            examples=["Running since 30 seconds ago."],
        ),
    ] = None


class JobType3(Enum):
    one_off = "one-off"


class JobsDefinedOneOffJob(JobsDefinedCommonJob):
    # Manually modified to have a default
    job_type: JobType3 = JobType3.one_off


class JobType4(Enum):
    scheduled = "scheduled"


class JobsDefinedScheduledJob(JobsDefinedCommonJob):
    # Manually modified to have a default
    job_type: JobType4 = JobType4.scheduled
    schedule: Annotated[
        str,
        Field(
            description="If the job is a cronjob, execution schedule.",
            examples=["@hourly"],
        ),
    ]
    schedule_actual: Annotated[
        Optional[str],
        Field(
            description="If the job is a cronjob, actual execution schedule.",
            examples=["15 * * * *"],
        ),
    ] = None
    timeout: Annotated[
        Optional[int],
        Field(
            description="Maximum amount of seconds the job will be allowed to run before it is failed",
            examples=[120],
            ge=0,
        ),
    ] = None


class JobType5(Enum):
    continuous = "continuous"


class JobsDefinedContinuousJob(JobsDefinedCommonJob):
    continuous: Annotated[
        Optional[bool],
        Field(
            description="If a job should be always running.\nThis is deprecated and is only here for backward compatibility.\nUse job_type instead.\n",
            examples=[True],
        ),
    ] = None
    # Manually modified to have a default
    job_type: JobType5 = JobType5.continuous
    replicas: Annotated[
        Optional[int],
        Field(
            description="Number of replicas to be used for the job", examples=[1], ge=1
        ),
    ] = None
    port: Annotated[
        Optional[int],
        Field(
            description="Port to expose for the job", examples=[8080], ge=1, le=65535
        ),
    ] = None
    # manually modified to use the enum as default
    port_protocol: Annotated[
        Optional[PortProtocol],
        Field(description="Protocol for the port exposed by the job", examples=["tcp"]),
    ] = PortProtocol.tcp
    health_check: Annotated[
        Optional[Union[JobsScriptHealthCheck, JobsHttpHealthCheck]],
        Field(
            description="Health check configuration for the job", discriminator="type"
        ),
    ] = None


class BuildsBuildCondition(BaseModel):
    message: Optional[str] = None
    status: Optional[BuildsBuildStatus] = None


class BuildsCancelResponse(BaseModel):
    id: Annotated[Optional[str], Field(description="Id of the cancelled build")] = None
    messages: Optional[BuildsResponseMessages] = None


class BuildsCleanResponse(BaseModel):
    messages: Optional[BuildsResponseMessages] = None


class BuildsDeleteResponse(BaseModel):
    id: Annotated[Optional[str], Field(description="Id of the deleted build")] = None
    messages: Optional[BuildsResponseMessages] = None


class BuildsHealthResponse(BaseModel):
    messages: Optional[BuildsResponseMessages] = None
    status: Optional[Status] = None


class BuildsQuotaCategory(BaseModel):
    items: Optional[List[BuildsQuotaCategoryItem]] = None
    name: Optional[str] = None


class ComponentsApiResponseDeployToken(BaseModel):
    data: ComponentsDeployToken
    messages: Annotated[Optional[ComponentsResponseMessages], Field()] = {
        "info": [],
        "warning": ["You are using a beta feature of Toolforge."],
        "error": [],
    }


class ComponentsApiResponseHealthState(BaseModel):
    data: ComponentsHealthState
    messages: Annotated[Optional[ComponentsResponseMessages], Field()] = {
        "info": [],
        "warning": ["You are using a beta feature of Toolforge."],
        "error": [],
    }


class ComponentsContinuousRunInfo(BaseModel):
    command: Annotated[
        str,
        Field(
            description="Command to use to run this component, `launcher` will be prepended to it to load the environment if needed.",
            examples=["bash -c 'while date; do sleep 10; done'"],
            title="Command",
        ),
    ]
    cpu: Annotated[
        Optional[str],
        Field(description="Job CPU resource limit.", examples=["1"], title="Cpu"),
    ] = None
    emails: Annotated[
        Optional[ComponentsEmails],
        Field(description="Job emails setting.", examples=["all"]),
    ] = None
    filelog: Annotated[
        Optional[bool],
        Field(
            description="Whether this job uses filelog or not.",
            examples=[False],
            title="Filelog",
        ),
    ] = None
    filelog_stderr: Annotated[
        Optional[str],
        Field(
            description="Path to the stderr file log.",
            examples=["logs/my-job.err"],
            title="Filelog Stderr",
        ),
    ] = None
    filelog_stdout: Annotated[
        Optional[str],
        Field(
            description="Path to the stdout file log.",
            examples=["logs/my-job.out"],
            title="Filelog Stdout",
        ),
    ] = None
    memory: Annotated[
        Optional[str],
        Field(
            description="Job memory resource limit.", examples=["1G"], title="Memory"
        ),
    ] = None
    mount: Annotated[
        Optional[ComponentsMount],
        Field(
            description="NFS mount configuration for the job.", examples=["none", "all"]
        ),
    ] = None
    port: Annotated[
        Optional[int],
        Field(
            description="Port where the service listens on. Other components can then address this one with `http://<this_component_name>:<port>`",
            examples=[8080],
            title="Port",
        ),
    ] = None
    replicas: Annotated[
        Optional[Replicas],
        Field(
            description="Number of replicas to be used for the job. Configurable only when continuous is true.",
            examples=[1],
            title="Replicas",
        ),
    ] = None
    health_check_script: Annotated[
        Optional[str],
        Field(
            description="Script/command to run to check that the service is running correctly. This will run inside the same container as the service itself.",
            examples=["test -e /tmp/everything_is_ok"],
            title="Health Check Script",
        ),
    ] = None
    health_check_http: Annotated[
        Optional[str],
        Field(
            description="HTTP path to query for the status of the system. It expects an HTTP 200 OK response, anything else is interpreted as failure.",
            examples=["/healthz"],
            title="Health Check Http",
        ),
    ] = None


class ComponentsDeploymentBuildInfo(BaseModel):
    build_id: Annotated[Union[str, BuildId], Field(title="Build Id")]
    build_status: ComponentsDeploymentBuildState
    build_long_status: Annotated[Optional[str], Field(title="Build Long Status")] = ""


class ComponentsDeploymentRunInfo(BaseModel):
    run_status: ComponentsDeploymentRunState
    run_long_status: Annotated[Optional[str], Field(title="Run Long Status")] = ""


class ComponentsHTTPValidationError(BaseModel):
    detail: Annotated[
        Optional[List[ComponentsValidationError]], Field(title="Detail")
    ] = None


class ComponentsScheduledComponentInfoInput(BaseModel):
    build: Annotated[
        Union[ComponentsSourceBuildInfo, ComponentsSourceBuildReference],
        Field(title="Build"),
    ]
    run: ComponentsScheduledRunInfo
    component_type: Annotated[Optional[str], Field(title="Component Type")] = (
        "scheduled"
    )


class ComponentsScheduledComponentInfoOutput(BaseModel):
    build: Annotated[
        Union[ComponentsSourceBuildInfo, ComponentsSourceBuildReference],
        Field(title="Build"),
    ]
    run: ComponentsScheduledRunInfo
    component_type: Annotated[Optional[str], Field(title="Component Type")] = (
        "scheduled"
    )


class EnvvarsEnvvar(BaseModel):
    name: EnvvarsEnvvarName
    value: Annotated[str, Field(description="Value of the envvar to store")]


class EnvvarsGetResponse(BaseModel):
    envvar: Optional[EnvvarsEnvvar] = None
    messages: Optional[EnvvarsResponseMessages] = None


class EnvvarsHealthResponse(BaseModel):
    messages: Optional[EnvvarsResponseMessages] = None
    status: Optional[Status] = None


class EnvvarsListResponse(BaseModel):
    envvars: Optional[List[EnvvarsEnvvar]] = None
    messages: Optional[EnvvarsResponseMessages] = None


class EnvvarsQuotaResponse(BaseModel):
    messages: Optional[EnvvarsResponseMessages] = None
    quota: Optional[EnvvarsEnvvarsQuota] = None


class JobsImageListResponse(BaseModel):
    images: Optional[List[JobsImage]] = None
    messages: Optional[JobsResponseMessages] = None


class JobsQuotaResponse(BaseModel):
    quota: Optional[JobsQuota] = None
    messages: Optional[JobsResponseMessages] = None


class JobsJobListResponse(BaseModel):
    jobs: Optional[
        List[
            Union[
                JobsDefinedOneOffJob, JobsDefinedScheduledJob, JobsDefinedContinuousJob
            ]
        ]
    ] = None
    messages: Optional[JobsResponseMessages] = None


class JobsJobResponse(BaseModel):
    messages: Optional[JobsResponseMessages] = None


class JobsHealthResponse(BaseModel):
    health: Optional[JobsHealth] = None
    messages: Optional[JobsResponseMessages] = None


class BuildsBuild(BuildsBuildCondition):
    build_id: Optional[str] = None
    destination_image: Optional[str] = None
    end_time: Optional[str] = None
    parameters: Optional[BuildsBuildParameters] = None
    resolved_ref: Optional[str] = None
    start_time: Optional[str] = None


class BuildsGetResponse(BaseModel):
    build: Optional[BuildsBuild] = None
    messages: Optional[BuildsResponseMessages] = None


class BuildsLatestResponse(BaseModel):
    build: Optional[BuildsBuild] = None
    messages: Optional[BuildsResponseMessages] = None


class BuildsListResponse(BaseModel):
    builds: Optional[List[BuildsBuild]] = None
    messages: Optional[BuildsResponseMessages] = None


class BuildsQuota(BaseModel):
    categories: Optional[List[BuildsQuotaCategory]] = None


class BuildsQuotaResponse(BaseModel):
    messages: Optional[BuildsResponseMessages] = None
    quota: Optional[BuildsQuota] = None


class ComponentsContinuousComponentInfoInput(BaseModel):
    build: Annotated[
        Union[ComponentsSourceBuildInfo, ComponentsSourceBuildReference],
        Field(title="Build"),
    ]
    run: ComponentsContinuousRunInfo
    component_type: Annotated[Optional[str], Field(title="Component Type")] = (
        "continuous"
    )


class ComponentsContinuousComponentInfoOutput(BaseModel):
    build: Annotated[
        Union[ComponentsSourceBuildInfo, ComponentsSourceBuildReference],
        Field(title="Build"),
    ]
    run: ComponentsContinuousRunInfo
    component_type: Annotated[Optional[str], Field(title="Component Type")] = (
        "continuous"
    )


class ComponentsToolConfigInput(BaseModel):
    config_version: Annotated[
        Optional[str], Field(examples=["v1beta1"], title="Config Version")
    ] = "v1beta1"
    source_url: Annotated[
        Optional[SourceUrl],
        Field(
            description="If passed, it will ignore anything else and try to fetch the configuration from the given URL on every deploy.",
            title="Source Url",
        ),
    ] = None
    components: Annotated[
        Dict[
            str,
            Union[
                ComponentsContinuousComponentInfoInput,
                ComponentsScheduledComponentInfoInput,
            ],
        ],
        Field(
            description="List of components to run. Each component matches a continuous job, scheduled job, one-off job or webservice.",
            title="Components",
        ),
    ]


class ComponentsToolConfigOutput(BaseModel):
    config_version: Annotated[
        Optional[str], Field(examples=["v1beta1"], title="Config Version")
    ] = "v1beta1"
    source_url: Annotated[
        Optional[SourceUrl],
        Field(
            description="If passed, it will ignore anything else and try to fetch the configuration from the given URL on every deploy.",
            title="Source Url",
        ),
    ] = None
    components: Annotated[
        Dict[
            str,
            Union[
                ComponentsContinuousComponentInfoOutput,
                ComponentsScheduledComponentInfoOutput,
            ],
        ],
        Field(
            description="List of components to run. Each component matches a continuous job, scheduled job, one-off job or webservice.",
            title="Components",
        ),
    ]


class ComponentsApiResponseToolConfig(BaseModel):
    data: ComponentsToolConfigOutput
    messages: Annotated[Optional[ComponentsResponseMessages], Field()] = {
        "info": [],
        "warning": ["You are using a beta feature of Toolforge."],
        "error": [],
    }


class ComponentsDeployment(BaseModel):
    deploy_id: Annotated[str, Field(title="Deploy Id")]
    creation_time: Annotated[str, Field(title="Creation Time")]
    builds: Annotated[Dict[str, ComponentsDeploymentBuildInfo], Field(title="Builds")]
    runs: Annotated[Dict[str, ComponentsDeploymentRunInfo], Field(title="Runs")]
    tool_config: Optional[ComponentsToolConfigOutput] = None
    status: Optional[ComponentsDeploymentState] = "pending"
    long_status: Annotated[Optional[str], Field(title="Long Status")] = ""
    force_build: Annotated[Optional[bool], Field(title="Force Build")] = False
    force_run: Annotated[Optional[bool], Field(title="Force Run")] = False


class ComponentsDeploymentList(BaseModel):
    deployments: Annotated[List[ComponentsDeployment], Field(title="Deployments")]


class ComponentsApiResponseDeploymentList(BaseModel):
    data: ComponentsDeploymentList
    messages: Annotated[Optional[ComponentsResponseMessages], Field()] = {
        "info": [],
        "warning": ["You are using a beta feature of Toolforge."],
        "error": [],
    }


class ComponentsApiResponseDeployment(BaseModel):
    data: ComponentsDeployment
    messages: Annotated[Optional[ComponentsResponseMessages], Field()] = {
        "info": [],
        "warning": ["You are using a beta feature of Toolforge."],
        "error": [],
    }
