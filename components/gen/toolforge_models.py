# generated by datamodel-codegen:
#   filename:  https://api.toolforge.org/openapi.json
#   timestamp: 2024-10-10T13:56:49+00:00

from __future__ import annotations

from enum import Enum
from typing import Dict, List, Literal, Optional

from pydantic import BaseModel, Field, RootModel, conint, constr


class BuildsBuildLog(BaseModel):
    line: Optional[str] = None


class BuildsBuildParameters(BaseModel):
    envvars: Optional[Dict[str, str]] = Field(
        None, description="Environment variables and values to be set at build time"
    )
    image_name: Optional[str] = Field(
        None, description="The name of the image to be built"
    )
    ref: Optional[str] = Field(
        None, description="Source code reference to build (ex. a git branch name)"
    )
    source_url: str = Field(
        ...,
        description="URL to the public git repository that contains the source code\nto build\n",
    )


class BuildsBuildStatus(Enum):
    BUILD_RUNNING = "BUILD_RUNNING"
    BUILD_SUCCESS = "BUILD_SUCCESS"
    BUILD_FAILURE = "BUILD_FAILURE"
    BUILD_CANCELLED = "BUILD_CANCELLED"
    BUILD_TIMEOUT = "BUILD_TIMEOUT"
    BUILD_UNKNOWN = "BUILD_UNKNOWN"


class Status(Enum):
    OK = "OK"
    ERROR = "ERROR"


class BuildsNewBuild(BaseModel):
    name: Optional[str] = None
    parameters: Optional[BuildsBuildParameters] = None


class BuildsQuotaCategoryItem(BaseModel):
    available: Optional[str] = None
    capacity: Optional[str] = None
    limit: Optional[str] = None
    name: Optional[str] = None
    used: Optional[str] = None


class BuildsResponseMessages(BaseModel):
    error: Optional[List[str]] = None
    info: Optional[List[str]] = None
    warning: Optional[List[str]] = None


class BuildsStartResponse(BaseModel):
    messages: Optional[BuildsResponseMessages] = None
    new_build: Optional[BuildsNewBuild] = None


class EnvvarsEnvvarName(RootModel[constr(pattern=r"^[A-Z_][A-Z_0-9]{3,}$")]):
    root: constr(pattern=r"^[A-Z_][A-Z_0-9]{3,}$")


class EnvvarsEnvvarsQuota(BaseModel):
    quota: Optional[int] = Field(None, description="The quota available to the user")
    used: Optional[int] = Field(None, description="The quota used by the user")


class EnvvarsResponseMessages(BaseModel):
    error: Optional[List[str]] = None
    info: Optional[List[str]] = None
    warning: Optional[List[str]] = None


class Emails(Enum):
    none = "none"
    all = "all"
    onfinish = "onfinish"
    onfailure = "onfailure"


class Mount(Enum):
    all = "all"
    none = "none"


class JobsHealth(BaseModel):
    message: Optional[str] = None
    status: Optional[Status] = None


class JobsImage(BaseModel):
    image: Optional[str] = None
    shortname: Optional[str] = None


class JobsJobLogs(RootModel[str]):
    root: str


class Item(BaseModel):
    limit: Optional[str] = None
    name: Optional[str] = None
    used: Optional[str] = None


class Category(BaseModel):
    items: Optional[List[Item]] = None
    name: Optional[str] = None


class JobsQuota(BaseModel):
    categories: Optional[List[Category]] = None


class JobsResponseMessages(BaseModel):
    error: Optional[List[str]] = None
    info: Optional[List[str]] = None
    warning: Optional[List[str]] = None


class JobsRestartResponse(BaseModel):
    messages: Optional[JobsResponseMessages] = None


class JobsScriptHealthCheck(BaseModel):
    script: str
    type: Literal["script"]


class JobsUpdateResponse(BaseModel):
    messages: Optional[JobsResponseMessages] = None


class BuildsBuildCondition(BaseModel):
    message: Optional[str] = None
    status: Optional[BuildsBuildStatus] = None


class BuildsCancelResponse(BaseModel):
    id: Optional[str] = Field(None, description="Id of the cancelled build")
    messages: Optional[BuildsResponseMessages] = None


class BuildsCleanResponse(BaseModel):
    messages: Optional[BuildsResponseMessages] = None


class BuildsDeleteResponse(BaseModel):
    id: Optional[str] = Field(None, description="Id of the deleted build")
    messages: Optional[BuildsResponseMessages] = None


class BuildsHealthResponse(BaseModel):
    messages: Optional[BuildsResponseMessages] = None
    status: Optional[Status] = None


class BuildsQuotaCategory(BaseModel):
    items: Optional[List[BuildsQuotaCategoryItem]] = None
    name: Optional[str] = None


class EnvvarsEnvvar(BaseModel):
    name: EnvvarsEnvvarName
    value: str = Field(..., description="Value of the envvar to store")


class EnvvarsGetResponse(BaseModel):
    envvar: Optional[EnvvarsEnvvar] = None
    messages: Optional[EnvvarsResponseMessages] = None


class EnvvarsHealthResponse(BaseModel):
    messages: Optional[EnvvarsResponseMessages] = None
    status: Optional[Status] = None


class EnvvarsListResponse(BaseModel):
    envvars: Optional[List[EnvvarsEnvvar]] = None
    messages: Optional[EnvvarsResponseMessages] = None


class EnvvarsQuotaResponse(BaseModel):
    messages: Optional[EnvvarsResponseMessages] = None
    quota: Optional[EnvvarsEnvvarsQuota] = None


class JobsCommonJob(BaseModel):
    cmd: str = Field(
        ...,
        description="Command that this job is executing.",
        examples=["./some-command.sh --with-args"],
    )
    continuous: Optional[bool] = Field(
        None, description="If a job should be always running.", examples=[False]
    )
    cpu: Optional[str] = Field(
        None, description="Job CPU resource limit.", examples=["1"]
    )
    emails: Optional[Emails] = Field(
        None, description="Job emails setting.", examples=["all"]
    )
    filelog: Optional[bool] = Field(
        None, description="Whether this job uses filelog or not.", examples=[False]
    )
    filelog_stderr: Optional[str] = Field(
        None, description="Path to the stderr file log.", examples=["logs/my-job.err"]
    )
    filelog_stdout: Optional[str] = Field(
        None, description="Path to the stdout file log.", examples=["logs/my-job.out"]
    )
    health_check: Optional[JobsScriptHealthCheck] = Field(
        None,
        description="Health check configuration for the job. Applicable only when continuous is true.",
        discriminator="type",
    )
    memory: Optional[str] = Field(
        None, description="Job memory resource limit.", examples=["1G"]
    )
    mount: Optional[Mount] = Field(
        None, description="NFS mount configuration for the job.", examples=["none"]
    )
    name: constr(
        pattern=r"^[a-z0-9]([-a-z0-9]*[a-z0-9])?([.][a-z0-9]([-a-z0-9]*[a-z0-9])?)*$",
        min_length=1,
        max_length=52,
    ) = Field(
        ..., description="Unique name that identifies the job.", examples=["my-job"]
    )
    port: Optional[conint(ge=1, le=65535)] = Field(
        None,
        description="Port to expose for the job. Applicable only when continuous is true.",
        examples=[8080],
    )
    replicas: Optional[conint(ge=1, le=2)] = Field(
        None,
        description="Number of replicas to be used for the job. Configurable only when continuous is true.",
        examples=[1],
    )
    retry: Optional[conint(ge=0, le=5)] = Field(
        None,
        description="Job retry policy. Zero means don't retry at all (the default)",
        examples=[0],
    )
    schedule: Optional[str] = Field(
        None,
        description="If the job is a cronjob, execution schedule.",
        examples=["@hourly"],
    )


class JobsDefinedJob(JobsCommonJob):
    image: str = Field(
        ...,
        description="Container image the job uses.",
        examples=["tool-my-tool/tool-my-tool:latest"],
    )
    image_state: str = Field(
        ...,
        description="Information about the image state, i.e, if it is stable, deprecated, or something else.",
        examples=["stable"],
    )
    schedule_actual: Optional[str] = Field(
        None,
        description="If the job is a cronjob, actual execution schedule.",
        examples=["15 * * * *"],
    )
    status_long: str = Field(
        ...,
        description="Job status, extended text.",
        examples=["Running since 30 seconds ago."],
    )
    status_short: str = Field(
        ..., description="Job status, short text.", examples=["Running."]
    )


class JobsDeleteResponse(BaseModel):
    messages: Optional[JobsResponseMessages] = None


class JobsFlushResponse(BaseModel):
    messages: Optional[JobsResponseMessages] = None


class JobsHealthResponse(BaseModel):
    health: Optional[JobsHealth] = None
    messages: Optional[JobsResponseMessages] = None


class JobsImageListResponse(BaseModel):
    images: Optional[List[JobsImage]] = None
    messages: Optional[JobsResponseMessages] = None


class JobsJobListResponse(BaseModel):
    jobs: Optional[List[JobsDefinedJob]] = None
    messages: Optional[JobsResponseMessages] = None


class JobsJobResponse(BaseModel):
    job: Optional[JobsDefinedJob] = None
    messages: Optional[JobsResponseMessages] = None


class JobsNewJob(JobsCommonJob):
    imagename: str = Field(
        ...,
        description="Container image the job uses.",
        examples=["tool-my-tool/tool-my-tool:latest"],
    )


class JobsQuotaResponse(BaseModel):
    messages: Optional[JobsResponseMessages] = None
    quota: Optional[JobsQuota] = None


class BuildsBuild(BuildsBuildCondition):
    build_id: Optional[str] = None
    destination_image: Optional[str] = None
    end_time: Optional[str] = None
    parameters: Optional[BuildsBuildParameters] = None
    start_time: Optional[str] = None


class BuildsGetResponse(BaseModel):
    build: Optional[BuildsBuild] = None
    messages: Optional[BuildsResponseMessages] = None


class BuildsLatestResponse(BaseModel):
    build: Optional[BuildsBuild] = None
    messages: Optional[BuildsResponseMessages] = None


class BuildsListResponse(BaseModel):
    builds: Optional[List[BuildsBuild]] = None
    messages: Optional[BuildsResponseMessages] = None


class BuildsQuota(BaseModel):
    categories: Optional[List[BuildsQuotaCategory]] = None


class BuildsQuotaResponse(BaseModel):
    messages: Optional[BuildsResponseMessages] = None
    quota: Optional[BuildsQuota] = None
